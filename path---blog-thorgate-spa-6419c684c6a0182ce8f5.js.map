{"version":3,"sources":["webpack:///path---blog-thorgate-spa-6419c684c6a0182ce8f5.js","webpack:///./.cache/json/blog-thorgate-spa.json"],"names":["webpackJsonp","445","module","exports","data","markdownRemark","html","frontmatter","title","pathContext","slug"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA;AAA+81CC,aAA2aC,MAAA,YAAmBC,aAAgBC,KAAA","file":"path---blog-thorgate-spa-6419c684c6a0182ce8f5.js","sourcesContent":["webpackJsonp([212854761677524],{\n\n/***/ 445:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1>SPA blog post - Getting started with Thorgate's SPA project template (???)</h1>\\n<p>(using Django, React, Redux, Redux Saga, Razzle, Docker)</p>\\n<p>Intro here - we at Thorgate have recently released a new version of our SPA\\ntemplate with Django, React, Redux and Redux Saga.</p>\\n<p><strong>TODO: Why SPA &#x26; trends n stuff</strong></p>\\n<p>TODO: I assume that you know a little bit about Django and a little bit of\\nReact. But since we're going through pretty simple examples, you can follow\\nalong.</p>\\n<p>Even if you don't start using our template, it's a good source of inspiration\\nfor your own project set up.</p>\\n<p>Here is the template:\\n<a href=\\\"https://gitlab.com/thorgate-public/django-project-template/tree/spa\\\">https://gitlab.com/thorgate-public/django-project-template/tree/spa</a>. This also\\nincludes a more standard Django application template on the <code>master</code> branch.</p>\\n<h2>Quick overview (??)</h2>\\n<p>The template is a <code>cookiecutter</code> template, meaning that it can easily be used\\nto generate your own project. The following technologies are set up by default:\\n<a href=\\\"https://www.djangoproject.com\\\">Django</a>, React, Redux, Razzle for server-side rendering, Docker,\\n<code>docker-compose</code> for super simple container management, <code>fabric</code> for automating\\ndeploys.</p>\\n<ul>\\n<li>Django - we are a Python shop/agency</li>\\n<li>React</li>\\n<li>Redux</li>\\n<li>Razzle - server-side rendering by default</li>\\n<li>PostgreSQL</li>\\n<li>SCSS</li>\\n<li>Docker</li>\\n<li>Docker-compose</li>\\n<li>Fabric - used for deploys</li>\\n</ul>\\n<p>There is more information in the <a href=\\\"https://gitlab.com\\\">readme</a>.</p>\\n<h2>Getting up and running</h2>\\n<h3>Requirements</h3>\\n<p>There are a couple of pre-requisites for generating the project and running it.\\nWe use Pipenv for managing Python dependencies and generating projects. If you\\nhaven't used Pipenv before, then it is a really nice package manager for\\nPython.</p>\\n<p>Firstly, make sure that you have <code>pipenv</code> available, it can easily be installed\\nfollowing the <a href=\\\"https://pipenv.readthedocs.io/en/latest/install/#installing-pipenv\\\">installation instructions</a> on their website. In\\norder to run the project, we also need Docker and <code>docker-compose</code>. Follow\\ninstructions on how to install those in <a href=\\\"https://docs.docker.com/engine/installation/\\\">Docker's\\ndocumentation</a> and <a href=\\\"https://docs.docker.com/compose/install/\\\">Docker\\nCompose's documentation</a>.</p>\\n<p>For reference, here are the versions of the packages I'm using:</p>\\n<pre><code>$ pipenv --version\\npipenv, version 2018.11.26\\n\\n$ docker --version\\nDocker version 18.09.0-ce, build 4d60db472b\\n\\n$ docker-compose --version\\ndocker-compose version 1.23.2, build unknown\\n</code></pre>\\n<h3>Generating the project</h3>\\n<p>Now that everything is set up, we can generate our project! Clone the project\\ntemplate anywhere on your file system and make sure to clone the <code>spa</code> branch:</p>\\n<pre><code>git clone https://gitlab.com/thorgate-public/django-project-template.git -b spa\\ncd django-project-template\\n</code></pre>\\n<p>Next, install the dependencies needed to build a new project. This includes\\n<code>cookiecutter</code> and a few other packages specified in the template's <code>Pipfile</code>.</p>\\n<pre><code>pipenv install\\n</code></pre>\\n<p>This installs the packages into a <code>django-project-template-XXXXXXXX</code> virtualenv\\nthat you don't even have to think about -- Pipenv manages all your\\ndependencies. Finally, we can generate a new project!</p>\\n<p>Let's activate the virtual environment Pipenv has created for us and navigate\\nto any folder you want the project to be in:</p>\\n<pre><code># Still in the django-project-template directory\\npipenv shell\\ncd ~/devel/awesome-projects\\n</code></pre>\\n<p>Now all that's left is to run <code>cookiecutter</code> to generate the project and answer\\nsome questions about it:</p>\\n<pre><code>cookiecutter path/to/django-project-template\\n</code></pre>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-66a4d.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 89.04255319148936%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACk0lEQVQ4y41UZ2/iQBQ0IRwioYTeu8EGgymhE0pILjnpyv//N3NvnmOE7oiUD0+7XnZn583MYkStOaKtCZLdLWLmBrH2GlGpuLnVMdHZIVwfIdjsI1Dvy3yITHeJbG+FdHeBVGeu80T7EUa2CyNUdhAs9PBgzgV0iYy9RrKzRMpaydoCaYvfc0QaI9wUbXB/uDxAqNTHbZHV03mwYMPIdGDc5G18Kzm4FdBYc4LSYIusLbdbCxQ5l9sL/Q1yslZ0tigPn/AgbCLVIe6E+X19jLsaR6+MSNVFtDFBvDVFc/aC7upNgQrOBs3HE2qTI+pS1fEBjekzSgJYlKrJd0paJjgZs0uWoX2nTf0oDp7QElAerI2PMBevCmYuvysAwXNkLJfx0mRnJoAz7Y4YihXIWbiRYv/UgqwI2p6/wj3+Oc+5bi4EeHKQFl3cN8ai8Uxlisr8rGPgA8wzZqYG5EWzymiv7DiSeVXGsrtT9vXpUVsna39vQfRNynmD/ROUN/EAo0DQtCXRsJcaB67xMupMgFxvrWbl+mvVkXPGJyG/qyl0iYYM97+ktWdU3L3eSiOoFcf6hyFkwZbDlYG6Src9DBchiZHBHEXkg5v9IgOKXxrutBXfdZ3LSM3IlpHxRxZxDIrJxbiK6wlMGThnRjWslyVOUiI/Jl7ZWrqfWhGQOpFZ3vE0Yr64zguoI0Mck3msOdV1NZMx+bcYB2f3E53lm+h4EpHn+pzIhoc0Vnn7v/IB/T1+GXSW+fKLevmM6SwZar6usLkGqoD6xPRpnTTE1vpdRxpEF68x+ZQhD9rrH2eHGQv+WTAWfkY/Y3P1EuaLDPXxy8iWmSuCXrr6FTDd1129S6B/qyl8VgSujA6q3VdBLusvHzTxv04PoqIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"generating the project\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-03540.png\\\"\\n        srcset=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-b012f.png 200w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-375a8.png 400w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-03540.png 800w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-66a4d.png 940w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>I named my project Parrot-mania as it can be used to save notable parrots.</p>\\n<p>Now that the project has been generated, we can deactivate the\\n<code>django-project-template</code> Pipenv environment since it only contains\\n<code>cookiecutter</code> and a few other packages. You can do this by just running\\n<code>exit</code>.</p>\\n<h3>Running the generated project</h3>\\n<p>A <code>Makefile</code> is included in the new project with helpers for running common\\ncommands. You don't need to know anything about <code>make</code> or <code>c</code>, they're just\\n<code>bash</code> commands. The <code>Makefile</code> also includes a set up script that should be\\nthe first thing to run when setting up a new project:</p>\\n<pre><code>make setup\\n</code></pre>\\n<p>You can find additional useful <code>make</code> scripts in the readme, or by checking out\\nthe <code>Makefile</code>.</p>\\n<p>This will create a new Pipenv environment for you, install packages, build the\\nnecessary Docker images, and run initial migrations. In addition, it will ask\\nyou to edit your local Django settings file, just save and close that. If the\\nsettings file opens in <code>vi</code>, then you can save and exit by typing\\n<code>&#x3C;Esc>:wq&#x3C;Enter></code>.</p>\\n<p>Now that the project is set up, we can run it through Docker and opening\\n<code>127.0.0.1:8000</code> in the browser:</p>\\n<pre><code>docker-compose up\\n# or\\nmake docker\\n</code></pre>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-86c11.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 49.89539748953975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAC4jAAAuIwF4pT92AAABc0lEQVQoz5WSS0sCUQCF5we4zHmgf6FWarko/AWNM+5atJSo/lNqSuYzlTKpSEgoghYtAhHa9S5InRnHcUZPc8cHKmV14ePcxzlnce+l3t4/QGhKMur1xkgbTQlqW7NoK4rFcD0N8RIkWQHF8zwIfr9g4p9QMRBAQBDABzexGtyy5mRPFMUJ+n4/BPOccjqd+AmWZcHZ52Bb24BtfRusOWc5Dg7HwEPU4ZjIUAxNg2EIzAg7bQdjli15vfC4XVhY8WF+2Qfvogcutxscx1oe2szR9DDb76HCkV2EwhHshMKWknVqL4FsLImjdB7FTAHF1AFyyTSS6QxKuUNkowlkovumJ4F4LD7KESj8ZfQGanR/tVJKS8U0stKC3CKoaGsdKI0mpM86FPP1VU0bO+8znqVIYJrhd9ANA3fVGgqlM5yUK8gfn+Lh6cXat77TN9mZhR3dQLV2j3LlCtc3tzi/uMTj8yt0/Z+F48VGtzdxjZ0ZZYQvIUhpuJaKi6IAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"landing page\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-03540.png\\\"\\n        srcset=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-b012f.png 200w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-375a8.png 400w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-03540.png 800w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-86c11.png 956w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>Just like that we have set up a new project with a Django API, a React\\nfront-end app with Redux and Redux Saga, server-side rendering using Razzle,\\nand a PostgreSQL database. Since all of these services are running in Docker\\ncontainers, we didn't need to install much locally.</p>\\n<h2>Overview of the structure</h2>\\n<p>Let's quickly go through the most important files and directories in our new\\nproject. First, the top level files and directories look like this:</p>\\n<pre><code>.\\n├── app/  - front-end web app\\n├── parrot_mania/  - back-end Django API\\n├── docker-compose.production.yml\\n├── docker-compose.yml\\n├── Dockerfile-django\\n├── Dockerfile-django.production\\n├── Dockerfile-node\\n├── Dockerfile-node.production\\n├── Makefile\\n└── Pipfile\\n</code></pre>\\n<p><code>docker-compose</code> and <code>Dockerfile</code> files are used to configure Docker, check\\nthem out if you'd like to know more. <code>Makefile</code> includes useful utilities like\\n<code>make setup</code>, <code>make makemigrations</code>, and <code>make quality</code>. A more in-depth list\\ncan be found in the <code>README.md</code> and, of course, you can just go through the\\n<code>Makefile</code> if you'd like a detailed overview of what's there.</p>\\n<p>The <code>app</code> directory includes these important files/directories:</p>\\n<pre><code>.\\n├── package.json\\n├── razzle.config.js  - Razzle's configuration file\\n├── SPA.md  - more information about the client app's structure\\n├── public/\\n└── src\\n    ├── components/  - standard React components\\n    ├── configuration/ - Redux &#x26; routes config\\n    ├── decorators/  - useful higher order components, e.g., loginRequired\\n    ├── ducks/  - Redux ducks\\n    ├── forms/  - Formik forms\\n    ├── sagas/  - Redux Saga sagas\\n    ├── settings/\\n    ├── styles\\n    │   ├── config/  - global variables &#x26; Bootstrap config\\n    │   └── main.scss  - all SCSS files are imported here\\n    ├── utils/  - useful utilities like translations and PropTypes\\n    └── views/  - pages\\n</code></pre>\\n<p>Since the project is based on <a href=\\\"https://github.com/jaredpalmer/razzle\\\">Razzle</a>, we include <code>razzle.config.js</code>\\nso that it can easily be configured.</p>\\n<p>We generally use <code>ducks</code> as a way to bundle together Redux actions, reducers,\\nand action types. You can read more about <code>ducks</code> here: <a href=\\\"https://github.com/erikras/ducks-modular-redux\\\">Ducks: Redux Reducer\\nBundles</a>.</p>\\n<p><a href=\\\"https://github.com/jaredpalmer/formik\\\">Formik</a> is a nice package for building forms in React without the\\ntears. These forms are located in <code>src/forms</code>. We'll go through a simple example\\nform together as well.</p>\\n<p>The backend structure is quite similar to a default Django app.</p>\\n<pre><code>.\\n├── accounts/\\n├── manage.py\\n├── parrot_mania/\\n└── settings\\n    ├── base.py\\n    ├── local.py\\n    ├── local.py.example\\n    ├── local_test.py\\n    ├── local_test.py.example\\n    ├── production.py\\n    ├── staging.py\\n    └── test.py\\n</code></pre>\\n<p>The main difference from a default installation are that JWT authentication is\\nalready set up, and that Django settings are divided into environment-based\\nconfiguration files. This means that one can easily use different settings for\\nproduction, development, and testing.</p>\\n<p>Don't worry if this seems a bit overwhelming right now, we'll go through some\\nsimple examples together.</p>\\n<h2>Our example app</h2>\\n<p>Now that you have a general overview of what the project structure is like, we\\ncan start building our small application!</p>\\n<p>I would like to create a simple Parrot reference web app that can be used to\\nkeep track of interesting parrots. Each user can create parrots and see a list\\nof their parrots. We'll make sure that server-side rendering works and make use\\nof some of the interesting technologies included in the project template.</p>\\n<h3>Showing parrots</h3>\\n<p>Let's start with showing the user their saved parrots. Since we already have\\nusers and authentication set up, then we don't need to spend too much effort on\\ngetting the current user's personal parrots.</p>\\n<p>Firstly, it's a good idea to create a superuser account for development. We\\nwould normally call <code>python manage.py createsuperuser</code> to create a superuser in\\nDjango, but since we're running everything inside Docker, then it would be a\\nbit trickier. Something like this: <code>docker-compose run --rm django python manage.py createsuperuser</code> would do the trick. But who can remember that? In\\norder to make it easier for everyone, the <code>Makefile</code> includes a useful alias for\\nrunning management commands: <code>make docker-manage cmd=\\\"createsuperuser\\\"</code>. Now we\\ncan either click on \\\"Admin panel\\\" in the navbar or go to\\n<code>http://127.0.0.1:8000/adminpanel/</code> to see the Django admin page.</p>\\n<p>Let's create a new app <code>parrots</code>!</p>\\n<pre><code>make docker-manage cmd=\\\"startapp parrots\\\"\\n</code></pre>\\n<p>Since the folder is created inside the Docker container, it is possible that\\nits permissions are incorrect. We can easily fix that by running.</p>\\n<pre><code>sudo chown -R \\\"$(id -un):$(id -gn)\\\" parrot_mania\\n</code></pre>\\n<p>We will also need to add our newly generated app to our <code>INSTALLED_APPS</code> in\\n<code>settings/base.py</code>:</p>\\n<pre><code>INSTALLED_APPS = [\\n    # Local apps\\n    'accounts',\\n    'parrot_mania',\\n    'parrots',\\n    ...\\n]\\n</code></pre>\\n<p>Now we can add our <code>Parrot</code> model in <code>parrots/models.py</code>:</p>\\n<pre><code>from django.db import models\\n\\nfrom accounts.models import User\\n\\n\\nclass Parrot(models.Model):\\n    name = models.CharField(max_length=255)\\n    link = models.TextField()\\n    user = models.ForeignKey(User)\\n</code></pre>\\n<p>And let's register the <code>Parrot</code> model to our admin site in <code>parrots/admin.py</code>\\nas well:</p>\\n<pre><code>from django.contrib import admin\\n\\nfrom parrots.models import Parrot\\n\\n\\nadmin.site.register(Parrot)\\n</code></pre>\\n<p>And let's migrate our database using aliases from the <code>Makefile</code>:</p>\\n<pre><code>make makemigrations\\nmake migrate\\n</code></pre>\\n<p>Now we can add parrots through the Django admin!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b25ea.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAC4jAAAuIwF4pT92AAABnElEQVQ4y52R204CQQyG98XUeIoRnkYRDwgvYDwEXkFBo7caoxHw1sQbiYlERVFIUBJxWfbAzs7u73RgdTlIok2+tNNpO21HmYxuIRTbwLyAdHh9AzMrmxiLbGN8qYuwp1Z2MBdLIpxIIRRPYXYtienVpNApyYywJ6I7UJbSWSSO8kgc5hE/zCF2kMVy5gILu71E9i5AsdFMh0h6kEURo+hthg/NgKpbMB1X4MFkLgzGB9DtXnyfYf/EKPBcWJYJ0iScO8Ls2P8RhXNR2TDgeZ50WKaJlqbBFD6C7gxdBxePuEPw/ZRPKHRgjH2/wGwberMJXVWhi8KyeKsl7/ykftzuRLKgX8jv0Nf9MsofzFWCjmGJ/ffDCvZ0GGydxHEctNtt2GJ0WkVwV5wPg0v8PcodWpb1/aKmNVEqlVAul6GqDREkft37wy9TVerEhzoMQj4udO2zhftaA4/vn3iqq1I/vDWkXazWUXiqyI5lhzTeb9D4rsNQeK3j5OYZZ7cvuLyr4Fzo00IZ2bsqjq+L2M9dgTn855dHyR8mxhd4LsRU2GSPEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"creating a parrot\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-03540.png\\\"\\n        srcset=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b012f.png 200w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-375a8.png 400w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-03540.png 800w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b25ea.png 980w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>The next step is to create a page on the front-end where we will show the\\nparrots. At first, let's use some dummy data so that we can focus on just\\nReact. Create a file at <code>app/src/views/ParrotsList.js</code>:</p>\\n<pre><code>import React from 'react';\\nimport { Container } from 'reactstrap';\\n\\nimport withView from 'decorators/withView';\\n\\nconst exampleParrots = [\\n    { id: 1, name: 'Alex', link: 'https://www.youtube.com/user/doorbell26' },\\n    { id: 2, name: 'Benjamin', link: 'https://www.youtube.com/user/parrotpost' },\\n];\\n\\nconst ParrotsList = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;ul>\\n            {exampleParrots.map((parrot) => (\\n                &#x3C;li key={parrot.id}>\\n                    &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                &#x3C;/li>\\n            ))}\\n        &#x3C;/ul>\\n    &#x3C;/Container>\\n);\\n\\nexport default withView()(ParrotsList);\\n</code></pre>\\n<p>But how do we say that this is an actual page that React will render on a\\nspecific URL? Well, we need to specify this in the <code>src/configuration.routes.js</code>\\nfile.</p>\\n<p>Add the following object towards the end of the existing routes, just above the\\nlast <code>NotFoundRoute</code>:</p>\\n<pre><code>...\\n{\\n    path: '/parrots',\\n    exact: true,\\n    name: 'parrots-list',\\n    component: ParrotsList,\\n},\\nNotFoundRoute,\\n</code></pre>\\n<p>We also need to import the component though, so let's add this to the top of\\nthe file:</p>\\n<pre><code>const ParrotsList = loadable(() => import('views/ParrotsList'));\\n</code></pre>\\n<p>This funny import handles code-splitting and dynamically loading only necessary\\nJavaScript for the page that the user is currently on.</p>\\n<p>Now we can navigate to <code>http://127.0.0.1:8000/parrots</code> and see our example\\nparrots!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-86c11.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 23.535564853556487%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAp0lEQVQY04WP2Q6CMBRE+///pxYRiEFAlsjeHce2CXEJxIeTmYe5kzukebRgjGOcZnAhMFs/zQxKGyxPeOVCQkjlWb3LtV3n6YYRwziht0oopbhEMcIowfEUIIoTBOfQQ4Mz7mUNqd6ln+pKVxgXHnKISxT2qKobXNOb9RXSLPea5YX9oLeFevPLLUjRG0xigTYG2m7UZvlir8zpFkQpF5C7gd+p/3gBLPOBl7f6xKcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"example parrots list\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-03540.png\\\"\\n        srcset=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-b012f.png 200w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-375a8.png 400w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-03540.png 800w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-86c11.png 956w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>This is a good time to make sure that our server-side rendering works, we can\\n<code>curl</code> the <code>/parrots</code> page:</p>\\n<pre><code>curl http://127.0.0.1:8000/parrots\\n\\n...\\n&#x3C;h1>Here are your parrots!&#x3C;/h1>\\n...\\n</code></pre>\\n<p>Even though the HTML is minified, we can see that includes our example parrots\\nand their links.</p>\\n<p>So far it has been a pretty standard Django and React application, but now that\\nwe need to show dynamic data to the user, we need communication between the\\nserver and the client. Let's first do this by just standard HTTP requests and\\nthen bring in Redux Saga later.</p>\\n<p>Firstly, we need an API endpoint to fetch parrots. Using Django Rest Framework,\\nit is possible to set up API endpoints very quickly. Let's create our DRF\\nserializer in <code>parrot_mania/parrots/serializers.py</code>:</p>\\n<pre><code>from rest_framework import serializers\\n\\nfrom parrots.models import Parrot\\n\\n\\nclass ParrotSerializer(serializers.ModelSerializer):\\n    class Meta:\\n        model = Parrot\\n        fields = ('id', 'name', 'link')\\n</code></pre>\\n<p>And our viewset in <code>parrot_mania/parrots/views.py</code>:</p>\\n<pre><code>from rest_framework import viewsets\\nfrom rest_framework.permissions import IsAuthenticated\\n\\nfrom parrots.models import Parrot\\nfrom parrots.serializers import ParrotSerializer\\n\\n\\nclass ParrotViewSet(viewsets.ModelViewSet):\\n    queryset = Parrot.objects.all()\\n    serializer_class = ParrotSerializer\\n    permission_classes = [IsAuthenticated]\\n\\n    def get_queryset(self):\\n        return super().get_queryset().filter(user=self.request.user)\\n</code></pre>\\n<p>And register the viewset's URLs using Django Rest Framework's router in\\n<code>parrot_mania/parrots/urls.py</code>:</p>\\n<pre><code>from rest_framework import routers\\n\\nfrom parrots.views import ParrotViewSet\\n\\n\\nrouter = routers.SimpleRouter()\\nrouter.register(r'parrots', ParrotViewSet, base_name='parrots')\\nurlpatterns = router.urls\\n</code></pre>\\n<p>And finally include these URLs in <code>parrot_mania/parrot_mania/rest/urls.py</code></p>\\n<pre><code>urlpatterns = [\\n    ...\\n    url(r'^', include('parrots.urls')),\\n]\\n</code></pre>\\n<p>We can test it out with <code>curl</code> if we remove the authentication check and\\ncurrent user filtering:</p>\\n<pre><code>class ParrotViewSet(viewsets.ModelViewSet):\\n    queryset = Parrot.objects.all()\\n    serializer_class = ParrotSerializer\\n    # permission_classes = [IsAuthenticated]\\n\\n    # def get_queryset(self):\\n    #     return super().get_queryset().filter(user=self.request.user)\\n</code></pre>\\n<pre><code>http://127.0.0.1:8000/api/parrots/\\n\\n[\\n    {\\\"id\\\":1,\\\"name\\\":\\\"Alex\\\",\\\"link\\\":\\\"https://www.youtube.com/user/doorbell26\\\"},\\n    {\\\"id\\\":2,\\\"name\\\":\\\"Benjamin\\\",\\\"link\\\":\\\"https://www.youtube.com/user/parrotpost\\\"}\\n]\\n</code></pre>\\n<p>We need to get this data to our front-end though. At first, let's try to do\\nthis with a simple <code>fetch</code> request:</p>\\n<pre><code>import React, { Component } from 'react';\\nimport { Container } from 'reactstrap';\\n\\nimport withView from 'decorators/withView';\\n\\nclass ParrotsList extends Component {\\n    state = {\\n        parrots: [],\\n    };\\n\\n    componentDidMount() {\\n        fetch('/api/parrots')\\n            .then((res) => res.json())\\n            .then((parrots) => {\\n                this.setState({ parrots });\\n            });\\n    }\\n\\n    render() {\\n        return (\\n            &#x3C;Container>\\n                &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n                &#x3C;ul>\\n                    {this.state.parrots.map((parrot) => (\\n                        &#x3C;li key={parrot.id}>\\n                            &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                        &#x3C;/li>\\n                    ))}\\n                &#x3C;/ul>\\n            &#x3C;/div>\\n        );\\n    }\\n}\\n\\nexport default withView()(ParrotsList);\\n</code></pre>\\n<p>The problem here though, is that the parrots do not get server-rendered anymore\\nsince they are fetched in <code>componentDidMount</code> -- when the component has been\\nrendered on the client side. In order to fix this, you can write your first\\nSaga. A saga listens to any dispatched Redux actions and can react to them --\\nfor example, dispatching more actions or making API requests. In our SPA\\nprojects, all communication with the API goes through Sagas.</p>\\n<p>The saga we will write will be very simple. It's going to be called whenever\\nanyone navigates to the <code>/parrots</code> route. In addition, it will be called on the\\nserver whenever the user <em>initially</em> navigates to the <code>/parrots</code> route.</p>\\n<p>At first, let's just log something to the console so that we see that it's\\nworking. Create a <code>app/src/sagas/parrots</code> directory and a <code>fetchUserParrots.js</code>\\nfile inside it with the following contents (make sure not to miss the <code>*</code> next\\nto <code>function</code>).</p>\\n<pre><code>export default function* fetchUserParrots() {\\n    console.log('Fetching some parrots!');\\n}\\n</code></pre>\\n<p>We also need to configure this saga to be triggered whenever users visit the\\n<code>/parrots</code> page. In order to do that, we can import the saga and modify our\\nroute configuration in <code>configuration/routes.js</code>:</p>\\n<pre><code>import fetchUserParrots from 'sagas/parrots/fetchUserParrots';\\n\\n...\\n\\n{\\n    path: '/parrots',\\n    exact: true,\\n    name: 'parrots-list',\\n    component: ParrotsList,\\n    initial: [\\n        fetchUserParrots,\\n    ],\\n},\\n</code></pre>\\n<p>Now we should see the logged message in the console.</p>\\n<p>Sagas offer a way of handling side effects in Redux projects (like API requests)\\nwhich are easy to manage and test. Redux Saga has a nice introduction on their\\nsite at <a href=\\\"https://redux-saga.js.org\\\">https://redux-saga.js.org</a>.</p>\\n<p>In our project template, the sagas specified in the <code>initial</code> array for each\\nroute are executed whenever a user visits the route. They're also executed on\\nthe server-side so that data can be fetched on the server and returned to the\\nuser when they first query the page.</p>\\n<p><strong>TODO</strong>: This is probably a good time to explain SSR? With some nice graphics</p>\\n<p>Now that we have a function that's triggered when the user queries <code>/parrots</code>,\\nwe can add API request logic there. But before that, let's create a Redux duck\\nfor containing the parrots. Create the <code>app/src/ducks/parrots.js</code> file and add\\nthe following:</p>\\n<pre><code>import { combineReducers } from 'redux';\\n\\nexport const RECEIVE_PARROTS = 'parrots/RECEIVE_PARROTS';\\n\\nconst parrotsReducer = (state = [], action) => {\\n    switch (action.type) {\\n        case RECEIVE_PARROTS:\\n            return action.parrots;\\n\\n        default:\\n            return state;\\n    }\\n};\\n\\nexport default combineReducers({\\n    parrots: parrotsReducer,\\n});\\n\\n\\n// Action creators\\n\\nexport const receiveParrots = (parrots) => ({\\n    type: RECEIVE_PARROTS,\\n    parrots,\\n});\\n</code></pre>\\n<p>We also need to configure our application to use the <code>parrots</code> duck. We can do\\nthat in <code>configuration/reducers.js</code>:</p>\\n<pre><code>import parrots from 'ducks/parrots';\\n\\nexport default (history) => combineReducers({\\n    ...\\n    parrots,\\n});\\n</code></pre>\\n<p>Finally, we can connect the <code>ParrotsList</code> component to the Redux store:</p>\\n<pre><code>import React from 'react';\\nimport { Container } from 'reactstrap';\\nimport { connect } from 'react-redux';\\n\\nimport withView from 'decorators/withView';\\n\\nconst ParrotsList = ({ parrots }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;ul>\\n            {parrots.map((parrot) => (\\n                &#x3C;li key={parrot.id}>\\n                    &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                &#x3C;/li>\\n            ))}\\n        &#x3C;/ul>\\n    &#x3C;/Container>\\n);\\n\\nconst mapStateToProps = (state) => ({\\n    parrots: state.parrots.parrots,\\n});\\n\\nconst ParrotsListConnector = connect(\\n    mapStateToProps,\\n)(ParrotsList);\\n\\nexport default withView()(ParrotsListConnector);\\n</code></pre>\\n<p>It is now possible to dispatch <code>RECEIVE_PARROTS</code> actions with some parrots and\\nsee them. Let's quickly try this out without any API requests just to make sure\\neverything works alright. Edit the <code>fetchUserParrots</code> saga:</p>\\n<pre><code>import { put } from 'redux-saga/effects';\\n\\nimport { receiveParrots } from 'ducks/parrots';\\n\\nexport default function* fetchUserParrots() {\\n    yield put(receiveParrots([\\n        { id: 1, name: 'Alex', link: 'https://www.youtube.com/user/doorbell26' },\\n        { id: 2, name: 'Benjamin', link: 'https://www.youtube.com/user/parrotpost' },\\n    ]));\\n}\\n</code></pre>\\n<p>And we should now be able to see the hard-coded parrots again! We dispatch the\\n<code>RECEIVE_PARROTS</code> action using <code>put</code>. The next thing to do is to make an API\\nrequest to retrieve the user's parrots and dispatch the action using those\\nparrots instead.</p>\\n<p>We could use <code>fetch</code> to make this API request, but we have a helper library for\\nmaking API requests called <code>tg-resources</code> (which uses <code>fetch</code> or <code>superagent</code>\\nunder the hood). Using <code>tg-resources</code>, we can configure a \\\"resource\\\" that can be\\nused to easily make API calls. Let's configure the <code>parrotsList</code> resource in\\n<code>services/api.js</code>. In the <code>createSagaRouter</code> arguments, add the <code>parrots</code>\\nresource like so:</p>\\n<pre><code>const api = createSagaRouter({\\n    ...\\n    parrots: {\\n        list: 'parrots/',\\n    },\\n}, {\\n    ...headers, apiRoot settings, etc.\\n});\\n</code></pre>\\n<p>We can now make use of this resource in the <code>fetchUserParrots</code> Saga:</p>\\n<pre><code>import { put } from 'redux-saga/effects';\\n\\nimport { receiveParrots } from 'ducks/parrots';\\nimport api from 'services/api';\\n\\nexport default function* fetchUserParrots() {\\n    try {\\n        const parrots = yield api.parrots.list.fetch();\\n        yield put(receiveParrots(parrots));\\n    } catch (err) {\\n        console.error('Something went wrong!');\\n    }\\n}\\n</code></pre>\\n<p>We call the <code>fetch</code> method on the <code>api.parrots.list</code> resource triggering a GET\\nrequest to <code>/api/parrots/</code>. Similarly, we could use <code>post</code> to make a POST\\nrequest with some data.</p>\\n<p>A simple way to check if server-side rendering works is to right click on the\\npage and selecting \\\"View Page Source\\\". The saved parrots should show up in the\\noriginal HTML the server sends to the browser.</p>\\n<p><strong>TODO: Explain generators and <code>yield</code>?</strong></p>\\n<h3>Creating parrots</h3>\\n<p>Currently, the only way to add parrots is via the admin page. This is a bit of a\\nproblem since then only admin users can add parrots. Also, it's quite\\ninconvenient to navigate to the \\\"add a parrot\\\" admin page. So, let's create a\\nnew view with a form for creating parrots.</p>\\n<p>Let's add a simple non-functional form view to <code>views/CreateParrot.js</code>:</p>\\n<pre><code>import React from 'react';\\nimport { Form, FormGroup, Label, Input, Button, Container } from 'reactstrap';\\n\\nconst CreateParrot = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Form>\\n            &#x3C;FormGroup>\\n                &#x3C;Label for=\\\"name\\\">Name&#x3C;/Label>\\n                &#x3C;Input name=\\\"name\\\" id=\\\"name\\\" />\\n            &#x3C;/FormGroup>\\n            &#x3C;FormGroup>\\n                &#x3C;Label for=\\\"link\\\">Link&#x3C;/Label>\\n                &#x3C;Input name=\\\"link\\\" id=\\\"link\\\" type=\\\"url\\\" />\\n            &#x3C;/FormGroup>\\n            &#x3C;Button>Create&#x3C;/Button>\\n        &#x3C;/Form>\\n    &#x3C;/Container>\\n);\\n\\nexport default CreateParrot;\\n</code></pre>\\n<p>And add a route for it in <code>configuration/routes.js</code>:</p>\\n<pre><code>const CreateParrot = loadable(() => import('views/CreateParrot'));\\n...\\n{\\n    path: '/parrots/create',\\n    exact: true,\\n    name: 'create-parrots',\\n    component: CreateParrot,\\n},\\n</code></pre>\\n<p>You should see a page like this at <code>/parrots/create</code>:</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-142b0.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 49.84709480122324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/0lEQVQoz52S207DMBBE/f+fwhMP/AOiQqhtGpAQ4gVR9QbN1UnsOFPP0hCXlnJ5ONo4ys7MeqMWyxVW6w2yvEBRauiqRqkrNMaiA9C6DnVjUNWN1PA5zXK8bxMkaSb9eVFCsZkiPFzfjDCNYkxnMWbxA0a3dxhPImmgAYUGDMq9ea9BFJ34MQ8vr3NpJtskxXrzJpUCzT5dCPtI+E718bWv2ju1zsmYjviZWY1tPfY0Ijgk/xSUFMaIwId7iD3D4b0OCf3Ij0/PWPoFMSWdv011lPCLIJ24lIvLK4yjexmZBodLOE8vqkJ113Ww/r7CX+S3HI18yu1fCX8S/GvSHeDlCJBahagrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"Create parrot form\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-03540.png\\\"\\n        srcset=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-b012f.png 200w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-375a8.png 400w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-03540.png 800w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-09d7b.png 1200w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-f2045.png 1600w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-142b0.png 1962w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>Unfortunately, we don't currently have access to any field values that the user\\ninputs. One option would be to convert the component to a class component and\\nkeep track of the name and the link in the component's state. Another option\\nwould be to use refs and manually query the name and link inputs for their\\nvalues when the user submits the form.</p>\\n<p>Those solutions require a lot of manual work though (especially for larger\\nforms). So, let's use a package that makes forms in React a breeze: Formik. We\\ncan convert our component to use Formik like so:</p>\\n<pre><code>import React from 'react';\\nimport { FormGroup, Label, Input, Button, Container } from 'reactstrap';\\nimport { Formik, Form } from 'formik';\\n\\nconst CreateParrot = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Formik\\n            initialValues={{ name: '', link: '' }}\\n            onSubmit={(values) => {\\n                console.log('Submitting!', values);\\n            }}\\n        >\\n            {({ values, handleChange }) => (\\n                &#x3C;Form>\\n                    &#x3C;FormGroup>\\n                        &#x3C;Label for=\\\"name\\\">Name&#x3C;/Label>\\n                        &#x3C;Input\\n                            name=\\\"name\\\"\\n                            id=\\\"name\\\"\\n                            value={values.name}\\n                            onChange={handleChange}\\n                        />\\n                    &#x3C;/FormGroup>\\n                    &#x3C;FormGroup>\\n                        &#x3C;Label for=\\\"link\\\">Link&#x3C;/Label>\\n                        &#x3C;Input\\n                            name=\\\"link\\\"\\n                            id=\\\"link\\\"\\n                            type=\\\"url\\\"\\n                            value={values.link}\\n                            onChange={handleChange}\\n                        />\\n                    &#x3C;/FormGroup>\\n                    &#x3C;Button type=\\\"submit\\\">Create&#x3C;/Button>\\n                &#x3C;/Form>\\n            )}\\n        &#x3C;/Formik>\\n    &#x3C;/Container>\\n);\\n\\nexport default CreateParrot;\\n</code></pre>\\n<p>Formik keeps track of the form's state internally and uses a render props based\\nAPI to allow us to access the state and modify it. It is very simple to add\\nvalidation, showing validation errors, and handling server errors. Even things\\nlike disabling the submit button when the user has clicked it is very simple.</p>\\n<p>You should now see a message logged to the console with the values you inputted.</p>\\n<p>Now, we need to send this data to the server so that the server can store the\\nparrot in the database. A very simple way to do it would be to just send a fetch\\nrequest in the <code>onSubmit</code> handler, but let's use a Saga for that.</p>\\n<p>Let's add a <code>createParrot.js</code> file to <code>sagas/parrots/</code> with the following\\ncontents:</p>\\n<pre><code>import { takeEvery } from 'redux-saga/effects';\\n\\n\\nconst CREATE_PARROT = 'CREATE_PARROT';\\n\\nexport const createParrot = (name, link) => ({\\n    type: CREATE_PARROT,\\n    name,\\n    link,\\n});\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    console.log('create parrot:', createParrotAction);\\n}\\n\\nexport default function* createParrotWatcher() {\\n    yield takeEvery(CREATE_PARROT, createParrotSaga);\\n}\\n</code></pre>\\n<p>This saga specifies its own action that it can react to -- <code>CREATE_PARROT</code>. The\\n<code>createParrotWatcher</code> will be watching for any dispatched <code>CREATE_PARROT</code>\\nactions and run <code>createParrotSaga</code> passing it the action as the argument.\\nCurrently we're just logging the <code>createParrotAction</code> in order to make sure that\\nwe get passed the correct data. Let's configure this Saga to \\\"watch\\\" for any\\nactions dispatched in the <code>/parrots/create</code> route by adding it as the <code>watcher</code>\\nfor that route in <code>routes.js</code>:</p>\\n<pre><code>{\\n    path: '/parrots/create',\\n    exact: true,\\n    name: 'create-parrots',\\n    component: CreateParrot,\\n    watcher: createParrotWatcher,\\n},\\n</code></pre>\\n<p>And finally, let's connect our <code>CreateParrot</code> component to Redux:</p>\\n<pre><code>...\\nimport { connect } from 'react-redux';\\n\\nimport { createParrot } from 'sagas/parrots/createParrot';\\n\\nconst CreateParrot = ({ createParrot }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Formik\\n            initialValues={{ name: '', link: '' }}\\n            onSubmit={(values) => {\\n                createParrot(values.name, values.link);\\n            }}\\n        >\\n            ...\\n        &#x3C;/Formik>\\n    &#x3C;/Container>\\n);\\n\\nconst mapDispatchToProps = (dispatch) => ({\\n    createParrot: (name, link) => dispatch(createParrot(name, link)),\\n});\\n\\nconst CreateParrotConnector = connect(\\n    null,\\n    mapDispatchToProps,\\n)(CreateParrot);\\n\\nexport default CreateParrotConnector;\\n</code></pre>\\n<p>Now, whenever the form is submitted, we dispatch the <code>CREATE_PARROT</code> action\\npassing it the name and the link.</p>\\n<p>We should now see the logged message in the console with the\\n<code>createParrotAction</code> including the specified <code>name</code> and <code>link</code>.</p>\\n<p>We can now send a POST request to the server using our <code>parrots.list</code> resource:</p>\\n<pre><code>...\\nimport api from 'services/api';\\n\\n...\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    try {\\n        const { name, link } = createParrotAction;\\n        yield api.parrots.list.post(null, { name, link });\\n    } catch (e) {\\n        console.log('Something went wrong!');\\n    }\\n}\\n\\n...\\n</code></pre>\\n<p>This <em>almost</em> works. We aren't currently sending the <code>user_id</code> field to the\\nserver, but since it's required, we get a <code>500</code> error saying that the <code>user_id</code>\\nfield cannot be <code>null</code>. It would be great if we didn't need to send this\\n<code>user_id</code> manually, but instead, Django would take the authenticated user and\\nsave the parrot to the database with that user's ID.</p>\\n<p>We can accomplish this very easily by overriding the <code>perform_create</code> method on\\nthe <code>ParrotViewSet</code> and passing the currently authenticated user to the\\nserializer:</p>\\n<pre><code>class ParrotViewSet(viewsets.ModelViewSet):\\n    ...\\n\\n    def perform_create(self, serializer):\\n        return serializer.save(user=self.request.user)\\n</code></pre>\\n<p>Creating parrots should now work! However, we don't actually see anything\\nhappening. Let's redirect the user to <code>/parrots</code> once the request has finished.\\nIn the <code>createParrot</code> Saga, modify the <code>createParrotSaga</code> function like so:</p>\\n<pre><code>import { push } from 'connected-react-router';\\nimport { takeEvery, put } from 'redux-saga/effects';\\n...\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    try {\\n        const { name, link } = createParrotAction;\\n        yield api.parrots.list.post(null, { name, link });\\n\\n        yield put(push('/parrots'));\\n    } catch (e) {\\n        console.log('Something went wrong!');\\n    }\\n}\\n\\n...\\n</code></pre>\\n<p>Let's also add a link to <code>/parrots/create</code> to our <code>ParrotsList</code> component:</p>\\n<pre><code>...\\nimport { Link } from 'react-router-dom';\\n...\\nconst ParrotsList = ({ parrots }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;Link to=\\\"/parrots/create\\\">\\n            Add a new parrot!\\n        &#x3C;/Link>\\n        ...\\n    &#x3C;/Container>\\n);\\n</code></pre>\\n<h3>Full source of Parrot-mania</h3>\\n<p>You can check out the full source of Parrot-mania here:\\n<a href=\\\"https://github.com/JoosepAlviste/parrot-mania\\\">https://github.com/JoosepAlviste/parrot-mania</a></p>\\n<h2>Future improvements to the template</h2>\\n<ul>\\n<li>Kubernetes</li>\\n<li>Out-of-the-box testing set up with <code>react-testing-library</code></li>\\n<li>GraphQL (???)</li>\\n</ul>\",\"frontmatter\":{\"title\":\"Charon\"}}},\"pathContext\":{\"slug\":\"/blog/thorgate-spa/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---blog-thorgate-spa-6419c684c6a0182ce8f5.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1>SPA blog post - Getting started with Thorgate's SPA project template (???)</h1>\\n<p>(using Django, React, Redux, Redux Saga, Razzle, Docker)</p>\\n<p>Intro here - we at Thorgate have recently released a new version of our SPA\\ntemplate with Django, React, Redux and Redux Saga.</p>\\n<p><strong>TODO: Why SPA &#x26; trends n stuff</strong></p>\\n<p>TODO: I assume that you know a little bit about Django and a little bit of\\nReact. But since we're going through pretty simple examples, you can follow\\nalong.</p>\\n<p>Even if you don't start using our template, it's a good source of inspiration\\nfor your own project set up.</p>\\n<p>Here is the template:\\n<a href=\\\"https://gitlab.com/thorgate-public/django-project-template/tree/spa\\\">https://gitlab.com/thorgate-public/django-project-template/tree/spa</a>. This also\\nincludes a more standard Django application template on the <code>master</code> branch.</p>\\n<h2>Quick overview (??)</h2>\\n<p>The template is a <code>cookiecutter</code> template, meaning that it can easily be used\\nto generate your own project. The following technologies are set up by default:\\n<a href=\\\"https://www.djangoproject.com\\\">Django</a>, React, Redux, Razzle for server-side rendering, Docker,\\n<code>docker-compose</code> for super simple container management, <code>fabric</code> for automating\\ndeploys.</p>\\n<ul>\\n<li>Django - we are a Python shop/agency</li>\\n<li>React</li>\\n<li>Redux</li>\\n<li>Razzle - server-side rendering by default</li>\\n<li>PostgreSQL</li>\\n<li>SCSS</li>\\n<li>Docker</li>\\n<li>Docker-compose</li>\\n<li>Fabric - used for deploys</li>\\n</ul>\\n<p>There is more information in the <a href=\\\"https://gitlab.com\\\">readme</a>.</p>\\n<h2>Getting up and running</h2>\\n<h3>Requirements</h3>\\n<p>There are a couple of pre-requisites for generating the project and running it.\\nWe use Pipenv for managing Python dependencies and generating projects. If you\\nhaven't used Pipenv before, then it is a really nice package manager for\\nPython.</p>\\n<p>Firstly, make sure that you have <code>pipenv</code> available, it can easily be installed\\nfollowing the <a href=\\\"https://pipenv.readthedocs.io/en/latest/install/#installing-pipenv\\\">installation instructions</a> on their website. In\\norder to run the project, we also need Docker and <code>docker-compose</code>. Follow\\ninstructions on how to install those in <a href=\\\"https://docs.docker.com/engine/installation/\\\">Docker's\\ndocumentation</a> and <a href=\\\"https://docs.docker.com/compose/install/\\\">Docker\\nCompose's documentation</a>.</p>\\n<p>For reference, here are the versions of the packages I'm using:</p>\\n<pre><code>$ pipenv --version\\npipenv, version 2018.11.26\\n\\n$ docker --version\\nDocker version 18.09.0-ce, build 4d60db472b\\n\\n$ docker-compose --version\\ndocker-compose version 1.23.2, build unknown\\n</code></pre>\\n<h3>Generating the project</h3>\\n<p>Now that everything is set up, we can generate our project! Clone the project\\ntemplate anywhere on your file system and make sure to clone the <code>spa</code> branch:</p>\\n<pre><code>git clone https://gitlab.com/thorgate-public/django-project-template.git -b spa\\ncd django-project-template\\n</code></pre>\\n<p>Next, install the dependencies needed to build a new project. This includes\\n<code>cookiecutter</code> and a few other packages specified in the template's <code>Pipfile</code>.</p>\\n<pre><code>pipenv install\\n</code></pre>\\n<p>This installs the packages into a <code>django-project-template-XXXXXXXX</code> virtualenv\\nthat you don't even have to think about -- Pipenv manages all your\\ndependencies. Finally, we can generate a new project!</p>\\n<p>Let's activate the virtual environment Pipenv has created for us and navigate\\nto any folder you want the project to be in:</p>\\n<pre><code># Still in the django-project-template directory\\npipenv shell\\ncd ~/devel/awesome-projects\\n</code></pre>\\n<p>Now all that's left is to run <code>cookiecutter</code> to generate the project and answer\\nsome questions about it:</p>\\n<pre><code>cookiecutter path/to/django-project-template\\n</code></pre>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-66a4d.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 89.04255319148936%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACk0lEQVQ4y41UZ2/iQBQ0IRwioYTeu8EGgymhE0pILjnpyv//N3NvnmOE7oiUD0+7XnZn583MYkStOaKtCZLdLWLmBrH2GlGpuLnVMdHZIVwfIdjsI1Dvy3yITHeJbG+FdHeBVGeu80T7EUa2CyNUdhAs9PBgzgV0iYy9RrKzRMpaydoCaYvfc0QaI9wUbXB/uDxAqNTHbZHV03mwYMPIdGDc5G18Kzm4FdBYc4LSYIusLbdbCxQ5l9sL/Q1yslZ0tigPn/AgbCLVIe6E+X19jLsaR6+MSNVFtDFBvDVFc/aC7upNgQrOBs3HE2qTI+pS1fEBjekzSgJYlKrJd0paJjgZs0uWoX2nTf0oDp7QElAerI2PMBevCmYuvysAwXNkLJfx0mRnJoAz7Y4YihXIWbiRYv/UgqwI2p6/wj3+Oc+5bi4EeHKQFl3cN8ai8Uxlisr8rGPgA8wzZqYG5EWzymiv7DiSeVXGsrtT9vXpUVsna39vQfRNynmD/ROUN/EAo0DQtCXRsJcaB67xMupMgFxvrWbl+mvVkXPGJyG/qyl0iYYM97+ktWdU3L3eSiOoFcf6hyFkwZbDlYG6Src9DBchiZHBHEXkg5v9IgOKXxrutBXfdZ3LSM3IlpHxRxZxDIrJxbiK6wlMGThnRjWslyVOUiI/Jl7ZWrqfWhGQOpFZ3vE0Yr64zguoI0Mck3msOdV1NZMx+bcYB2f3E53lm+h4EpHn+pzIhoc0Vnn7v/IB/T1+GXSW+fKLevmM6SwZar6usLkGqoD6xPRpnTTE1vpdRxpEF68x+ZQhD9rrH2eHGQv+WTAWfkY/Y3P1EuaLDPXxy8iWmSuCXrr6FTDd1129S6B/qyl8VgSujA6q3VdBLusvHzTxv04PoqIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"generating the project\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-03540.png\\\"\\n        srcset=\\\"/static/generate-project-138639ea9fac57804ee4d8286e3cadff-b012f.png 200w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-375a8.png 400w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-03540.png 800w,\\n/static/generate-project-138639ea9fac57804ee4d8286e3cadff-66a4d.png 940w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>I named my project Parrot-mania as it can be used to save notable parrots.</p>\\n<p>Now that the project has been generated, we can deactivate the\\n<code>django-project-template</code> Pipenv environment since it only contains\\n<code>cookiecutter</code> and a few other packages. You can do this by just running\\n<code>exit</code>.</p>\\n<h3>Running the generated project</h3>\\n<p>A <code>Makefile</code> is included in the new project with helpers for running common\\ncommands. You don't need to know anything about <code>make</code> or <code>c</code>, they're just\\n<code>bash</code> commands. The <code>Makefile</code> also includes a set up script that should be\\nthe first thing to run when setting up a new project:</p>\\n<pre><code>make setup\\n</code></pre>\\n<p>You can find additional useful <code>make</code> scripts in the readme, or by checking out\\nthe <code>Makefile</code>.</p>\\n<p>This will create a new Pipenv environment for you, install packages, build the\\nnecessary Docker images, and run initial migrations. In addition, it will ask\\nyou to edit your local Django settings file, just save and close that. If the\\nsettings file opens in <code>vi</code>, then you can save and exit by typing\\n<code>&#x3C;Esc>:wq&#x3C;Enter></code>.</p>\\n<p>Now that the project is set up, we can run it through Docker and opening\\n<code>127.0.0.1:8000</code> in the browser:</p>\\n<pre><code>docker-compose up\\n# or\\nmake docker\\n</code></pre>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-86c11.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 49.89539748953975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAC4jAAAuIwF4pT92AAABc0lEQVQoz5WSS0sCUQCF5we4zHmgf6FWarko/AWNM+5atJSo/lNqSuYzlTKpSEgoghYtAhHa9S5InRnHcUZPc8cHKmV14ePcxzlnce+l3t4/QGhKMur1xkgbTQlqW7NoK4rFcD0N8RIkWQHF8zwIfr9g4p9QMRBAQBDABzexGtyy5mRPFMUJ+n4/BPOccjqd+AmWZcHZ52Bb24BtfRusOWc5Dg7HwEPU4ZjIUAxNg2EIzAg7bQdjli15vfC4XVhY8WF+2Qfvogcutxscx1oe2szR9DDb76HCkV2EwhHshMKWknVqL4FsLImjdB7FTAHF1AFyyTSS6QxKuUNkowlkovumJ4F4LD7KESj8ZfQGanR/tVJKS8U0stKC3CKoaGsdKI0mpM86FPP1VU0bO+8znqVIYJrhd9ANA3fVGgqlM5yUK8gfn+Lh6cXat77TN9mZhR3dQLV2j3LlCtc3tzi/uMTj8yt0/Z+F48VGtzdxjZ0ZZYQvIUhpuJaKi6IAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"landing page\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-03540.png\\\"\\n        srcset=\\\"/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-b012f.png 200w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-375a8.png 400w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-03540.png 800w,\\n/static/landing-page-0c09d4f82a504f4106325d0088f4fefb-86c11.png 956w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>Just like that we have set up a new project with a Django API, a React\\nfront-end app with Redux and Redux Saga, server-side rendering using Razzle,\\nand a PostgreSQL database. Since all of these services are running in Docker\\ncontainers, we didn't need to install much locally.</p>\\n<h2>Overview of the structure</h2>\\n<p>Let's quickly go through the most important files and directories in our new\\nproject. First, the top level files and directories look like this:</p>\\n<pre><code>.\\n├── app/  - front-end web app\\n├── parrot_mania/  - back-end Django API\\n├── docker-compose.production.yml\\n├── docker-compose.yml\\n├── Dockerfile-django\\n├── Dockerfile-django.production\\n├── Dockerfile-node\\n├── Dockerfile-node.production\\n├── Makefile\\n└── Pipfile\\n</code></pre>\\n<p><code>docker-compose</code> and <code>Dockerfile</code> files are used to configure Docker, check\\nthem out if you'd like to know more. <code>Makefile</code> includes useful utilities like\\n<code>make setup</code>, <code>make makemigrations</code>, and <code>make quality</code>. A more in-depth list\\ncan be found in the <code>README.md</code> and, of course, you can just go through the\\n<code>Makefile</code> if you'd like a detailed overview of what's there.</p>\\n<p>The <code>app</code> directory includes these important files/directories:</p>\\n<pre><code>.\\n├── package.json\\n├── razzle.config.js  - Razzle's configuration file\\n├── SPA.md  - more information about the client app's structure\\n├── public/\\n└── src\\n    ├── components/  - standard React components\\n    ├── configuration/ - Redux &#x26; routes config\\n    ├── decorators/  - useful higher order components, e.g., loginRequired\\n    ├── ducks/  - Redux ducks\\n    ├── forms/  - Formik forms\\n    ├── sagas/  - Redux Saga sagas\\n    ├── settings/\\n    ├── styles\\n    │   ├── config/  - global variables &#x26; Bootstrap config\\n    │   └── main.scss  - all SCSS files are imported here\\n    ├── utils/  - useful utilities like translations and PropTypes\\n    └── views/  - pages\\n</code></pre>\\n<p>Since the project is based on <a href=\\\"https://github.com/jaredpalmer/razzle\\\">Razzle</a>, we include <code>razzle.config.js</code>\\nso that it can easily be configured.</p>\\n<p>We generally use <code>ducks</code> as a way to bundle together Redux actions, reducers,\\nand action types. You can read more about <code>ducks</code> here: <a href=\\\"https://github.com/erikras/ducks-modular-redux\\\">Ducks: Redux Reducer\\nBundles</a>.</p>\\n<p><a href=\\\"https://github.com/jaredpalmer/formik\\\">Formik</a> is a nice package for building forms in React without the\\ntears. These forms are located in <code>src/forms</code>. We'll go through a simple example\\nform together as well.</p>\\n<p>The backend structure is quite similar to a default Django app.</p>\\n<pre><code>.\\n├── accounts/\\n├── manage.py\\n├── parrot_mania/\\n└── settings\\n    ├── base.py\\n    ├── local.py\\n    ├── local.py.example\\n    ├── local_test.py\\n    ├── local_test.py.example\\n    ├── production.py\\n    ├── staging.py\\n    └── test.py\\n</code></pre>\\n<p>The main difference from a default installation are that JWT authentication is\\nalready set up, and that Django settings are divided into environment-based\\nconfiguration files. This means that one can easily use different settings for\\nproduction, development, and testing.</p>\\n<p>Don't worry if this seems a bit overwhelming right now, we'll go through some\\nsimple examples together.</p>\\n<h2>Our example app</h2>\\n<p>Now that you have a general overview of what the project structure is like, we\\ncan start building our small application!</p>\\n<p>I would like to create a simple Parrot reference web app that can be used to\\nkeep track of interesting parrots. Each user can create parrots and see a list\\nof their parrots. We'll make sure that server-side rendering works and make use\\nof some of the interesting technologies included in the project template.</p>\\n<h3>Showing parrots</h3>\\n<p>Let's start with showing the user their saved parrots. Since we already have\\nusers and authentication set up, then we don't need to spend too much effort on\\ngetting the current user's personal parrots.</p>\\n<p>Firstly, it's a good idea to create a superuser account for development. We\\nwould normally call <code>python manage.py createsuperuser</code> to create a superuser in\\nDjango, but since we're running everything inside Docker, then it would be a\\nbit trickier. Something like this: <code>docker-compose run --rm django python manage.py createsuperuser</code> would do the trick. But who can remember that? In\\norder to make it easier for everyone, the <code>Makefile</code> includes a useful alias for\\nrunning management commands: <code>make docker-manage cmd=\\\"createsuperuser\\\"</code>. Now we\\ncan either click on \\\"Admin panel\\\" in the navbar or go to\\n<code>http://127.0.0.1:8000/adminpanel/</code> to see the Django admin page.</p>\\n<p>Let's create a new app <code>parrots</code>!</p>\\n<pre><code>make docker-manage cmd=\\\"startapp parrots\\\"\\n</code></pre>\\n<p>Since the folder is created inside the Docker container, it is possible that\\nits permissions are incorrect. We can easily fix that by running.</p>\\n<pre><code>sudo chown -R \\\"$(id -un):$(id -gn)\\\" parrot_mania\\n</code></pre>\\n<p>We will also need to add our newly generated app to our <code>INSTALLED_APPS</code> in\\n<code>settings/base.py</code>:</p>\\n<pre><code>INSTALLED_APPS = [\\n    # Local apps\\n    'accounts',\\n    'parrot_mania',\\n    'parrots',\\n    ...\\n]\\n</code></pre>\\n<p>Now we can add our <code>Parrot</code> model in <code>parrots/models.py</code>:</p>\\n<pre><code>from django.db import models\\n\\nfrom accounts.models import User\\n\\n\\nclass Parrot(models.Model):\\n    name = models.CharField(max_length=255)\\n    link = models.TextField()\\n    user = models.ForeignKey(User)\\n</code></pre>\\n<p>And let's register the <code>Parrot</code> model to our admin site in <code>parrots/admin.py</code>\\nas well:</p>\\n<pre><code>from django.contrib import admin\\n\\nfrom parrots.models import Parrot\\n\\n\\nadmin.site.register(Parrot)\\n</code></pre>\\n<p>And let's migrate our database using aliases from the <code>Makefile</code>:</p>\\n<pre><code>make makemigrations\\nmake migrate\\n</code></pre>\\n<p>Now we can add parrots through the Django admin!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b25ea.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAC4jAAAuIwF4pT92AAABnElEQVQ4y52R204CQQyG98XUeIoRnkYRDwgvYDwEXkFBo7caoxHw1sQbiYlERVFIUBJxWfbAzs7u73RgdTlIok2+tNNpO21HmYxuIRTbwLyAdHh9AzMrmxiLbGN8qYuwp1Z2MBdLIpxIIRRPYXYtienVpNApyYywJ6I7UJbSWSSO8kgc5hE/zCF2kMVy5gILu71E9i5AsdFMh0h6kEURo+hthg/NgKpbMB1X4MFkLgzGB9DtXnyfYf/EKPBcWJYJ0iScO8Ls2P8RhXNR2TDgeZ50WKaJlqbBFD6C7gxdBxePuEPw/ZRPKHRgjH2/wGwberMJXVWhi8KyeKsl7/ykftzuRLKgX8jv0Nf9MsofzFWCjmGJ/ffDCvZ0GGydxHEctNtt2GJ0WkVwV5wPg0v8PcodWpb1/aKmNVEqlVAul6GqDREkft37wy9TVerEhzoMQj4udO2zhftaA4/vn3iqq1I/vDWkXazWUXiqyI5lhzTeb9D4rsNQeK3j5OYZZ7cvuLyr4Fzo00IZ2bsqjq+L2M9dgTn855dHyR8mxhd4LsRU2GSPEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"creating a parrot\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-03540.png\\\"\\n        srcset=\\\"/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b012f.png 200w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-375a8.png 400w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-03540.png 800w,\\n/static/creating-a-parrot-8c654c7a6551e08e9389f7bf8a5f84ba-b25ea.png 980w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>The next step is to create a page on the front-end where we will show the\\nparrots. At first, let's use some dummy data so that we can focus on just\\nReact. Create a file at <code>app/src/views/ParrotsList.js</code>:</p>\\n<pre><code>import React from 'react';\\nimport { Container } from 'reactstrap';\\n\\nimport withView from 'decorators/withView';\\n\\nconst exampleParrots = [\\n    { id: 1, name: 'Alex', link: 'https://www.youtube.com/user/doorbell26' },\\n    { id: 2, name: 'Benjamin', link: 'https://www.youtube.com/user/parrotpost' },\\n];\\n\\nconst ParrotsList = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;ul>\\n            {exampleParrots.map((parrot) => (\\n                &#x3C;li key={parrot.id}>\\n                    &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                &#x3C;/li>\\n            ))}\\n        &#x3C;/ul>\\n    &#x3C;/Container>\\n);\\n\\nexport default withView()(ParrotsList);\\n</code></pre>\\n<p>But how do we say that this is an actual page that React will render on a\\nspecific URL? Well, we need to specify this in the <code>src/configuration.routes.js</code>\\nfile.</p>\\n<p>Add the following object towards the end of the existing routes, just above the\\nlast <code>NotFoundRoute</code>:</p>\\n<pre><code>...\\n{\\n    path: '/parrots',\\n    exact: true,\\n    name: 'parrots-list',\\n    component: ParrotsList,\\n},\\nNotFoundRoute,\\n</code></pre>\\n<p>We also need to import the component though, so let's add this to the top of\\nthe file:</p>\\n<pre><code>const ParrotsList = loadable(() => import('views/ParrotsList'));\\n</code></pre>\\n<p>This funny import handles code-splitting and dynamically loading only necessary\\nJavaScript for the page that the user is currently on.</p>\\n<p>Now we can navigate to <code>http://127.0.0.1:8000/parrots</code> and see our example\\nparrots!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-86c11.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 23.535564853556487%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAp0lEQVQY04WP2Q6CMBRE+///pxYRiEFAlsjeHce2CXEJxIeTmYe5kzukebRgjGOcZnAhMFs/zQxKGyxPeOVCQkjlWb3LtV3n6YYRwziht0oopbhEMcIowfEUIIoTBOfQQ4Mz7mUNqd6ln+pKVxgXHnKISxT2qKobXNOb9RXSLPea5YX9oLeFevPLLUjRG0xigTYG2m7UZvlir8zpFkQpF5C7gd+p/3gBLPOBl7f6xKcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"example parrots list\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-03540.png\\\"\\n        srcset=\\\"/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-b012f.png 200w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-375a8.png 400w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-03540.png 800w,\\n/static/example-parrots-list-4492c4a9c5c1f248a100a2f2126b37f3-86c11.png 956w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>This is a good time to make sure that our server-side rendering works, we can\\n<code>curl</code> the <code>/parrots</code> page:</p>\\n<pre><code>curl http://127.0.0.1:8000/parrots\\n\\n...\\n&#x3C;h1>Here are your parrots!&#x3C;/h1>\\n...\\n</code></pre>\\n<p>Even though the HTML is minified, we can see that includes our example parrots\\nand their links.</p>\\n<p>So far it has been a pretty standard Django and React application, but now that\\nwe need to show dynamic data to the user, we need communication between the\\nserver and the client. Let's first do this by just standard HTTP requests and\\nthen bring in Redux Saga later.</p>\\n<p>Firstly, we need an API endpoint to fetch parrots. Using Django Rest Framework,\\nit is possible to set up API endpoints very quickly. Let's create our DRF\\nserializer in <code>parrot_mania/parrots/serializers.py</code>:</p>\\n<pre><code>from rest_framework import serializers\\n\\nfrom parrots.models import Parrot\\n\\n\\nclass ParrotSerializer(serializers.ModelSerializer):\\n    class Meta:\\n        model = Parrot\\n        fields = ('id', 'name', 'link')\\n</code></pre>\\n<p>And our viewset in <code>parrot_mania/parrots/views.py</code>:</p>\\n<pre><code>from rest_framework import viewsets\\nfrom rest_framework.permissions import IsAuthenticated\\n\\nfrom parrots.models import Parrot\\nfrom parrots.serializers import ParrotSerializer\\n\\n\\nclass ParrotViewSet(viewsets.ModelViewSet):\\n    queryset = Parrot.objects.all()\\n    serializer_class = ParrotSerializer\\n    permission_classes = [IsAuthenticated]\\n\\n    def get_queryset(self):\\n        return super().get_queryset().filter(user=self.request.user)\\n</code></pre>\\n<p>And register the viewset's URLs using Django Rest Framework's router in\\n<code>parrot_mania/parrots/urls.py</code>:</p>\\n<pre><code>from rest_framework import routers\\n\\nfrom parrots.views import ParrotViewSet\\n\\n\\nrouter = routers.SimpleRouter()\\nrouter.register(r'parrots', ParrotViewSet, base_name='parrots')\\nurlpatterns = router.urls\\n</code></pre>\\n<p>And finally include these URLs in <code>parrot_mania/parrot_mania/rest/urls.py</code></p>\\n<pre><code>urlpatterns = [\\n    ...\\n    url(r'^', include('parrots.urls')),\\n]\\n</code></pre>\\n<p>We can test it out with <code>curl</code> if we remove the authentication check and\\ncurrent user filtering:</p>\\n<pre><code>class ParrotViewSet(viewsets.ModelViewSet):\\n    queryset = Parrot.objects.all()\\n    serializer_class = ParrotSerializer\\n    # permission_classes = [IsAuthenticated]\\n\\n    # def get_queryset(self):\\n    #     return super().get_queryset().filter(user=self.request.user)\\n</code></pre>\\n<pre><code>http://127.0.0.1:8000/api/parrots/\\n\\n[\\n    {\\\"id\\\":1,\\\"name\\\":\\\"Alex\\\",\\\"link\\\":\\\"https://www.youtube.com/user/doorbell26\\\"},\\n    {\\\"id\\\":2,\\\"name\\\":\\\"Benjamin\\\",\\\"link\\\":\\\"https://www.youtube.com/user/parrotpost\\\"}\\n]\\n</code></pre>\\n<p>We need to get this data to our front-end though. At first, let's try to do\\nthis with a simple <code>fetch</code> request:</p>\\n<pre><code>import React, { Component } from 'react';\\nimport { Container } from 'reactstrap';\\n\\nimport withView from 'decorators/withView';\\n\\nclass ParrotsList extends Component {\\n    state = {\\n        parrots: [],\\n    };\\n\\n    componentDidMount() {\\n        fetch('/api/parrots')\\n            .then((res) => res.json())\\n            .then((parrots) => {\\n                this.setState({ parrots });\\n            });\\n    }\\n\\n    render() {\\n        return (\\n            &#x3C;Container>\\n                &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n                &#x3C;ul>\\n                    {this.state.parrots.map((parrot) => (\\n                        &#x3C;li key={parrot.id}>\\n                            &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                        &#x3C;/li>\\n                    ))}\\n                &#x3C;/ul>\\n            &#x3C;/div>\\n        );\\n    }\\n}\\n\\nexport default withView()(ParrotsList);\\n</code></pre>\\n<p>The problem here though, is that the parrots do not get server-rendered anymore\\nsince they are fetched in <code>componentDidMount</code> -- when the component has been\\nrendered on the client side. In order to fix this, you can write your first\\nSaga. A saga listens to any dispatched Redux actions and can react to them --\\nfor example, dispatching more actions or making API requests. In our SPA\\nprojects, all communication with the API goes through Sagas.</p>\\n<p>The saga we will write will be very simple. It's going to be called whenever\\nanyone navigates to the <code>/parrots</code> route. In addition, it will be called on the\\nserver whenever the user <em>initially</em> navigates to the <code>/parrots</code> route.</p>\\n<p>At first, let's just log something to the console so that we see that it's\\nworking. Create a <code>app/src/sagas/parrots</code> directory and a <code>fetchUserParrots.js</code>\\nfile inside it with the following contents (make sure not to miss the <code>*</code> next\\nto <code>function</code>).</p>\\n<pre><code>export default function* fetchUserParrots() {\\n    console.log('Fetching some parrots!');\\n}\\n</code></pre>\\n<p>We also need to configure this saga to be triggered whenever users visit the\\n<code>/parrots</code> page. In order to do that, we can import the saga and modify our\\nroute configuration in <code>configuration/routes.js</code>:</p>\\n<pre><code>import fetchUserParrots from 'sagas/parrots/fetchUserParrots';\\n\\n...\\n\\n{\\n    path: '/parrots',\\n    exact: true,\\n    name: 'parrots-list',\\n    component: ParrotsList,\\n    initial: [\\n        fetchUserParrots,\\n    ],\\n},\\n</code></pre>\\n<p>Now we should see the logged message in the console.</p>\\n<p>Sagas offer a way of handling side effects in Redux projects (like API requests)\\nwhich are easy to manage and test. Redux Saga has a nice introduction on their\\nsite at <a href=\\\"https://redux-saga.js.org\\\">https://redux-saga.js.org</a>.</p>\\n<p>In our project template, the sagas specified in the <code>initial</code> array for each\\nroute are executed whenever a user visits the route. They're also executed on\\nthe server-side so that data can be fetched on the server and returned to the\\nuser when they first query the page.</p>\\n<p><strong>TODO</strong>: This is probably a good time to explain SSR? With some nice graphics</p>\\n<p>Now that we have a function that's triggered when the user queries <code>/parrots</code>,\\nwe can add API request logic there. But before that, let's create a Redux duck\\nfor containing the parrots. Create the <code>app/src/ducks/parrots.js</code> file and add\\nthe following:</p>\\n<pre><code>import { combineReducers } from 'redux';\\n\\nexport const RECEIVE_PARROTS = 'parrots/RECEIVE_PARROTS';\\n\\nconst parrotsReducer = (state = [], action) => {\\n    switch (action.type) {\\n        case RECEIVE_PARROTS:\\n            return action.parrots;\\n\\n        default:\\n            return state;\\n    }\\n};\\n\\nexport default combineReducers({\\n    parrots: parrotsReducer,\\n});\\n\\n\\n// Action creators\\n\\nexport const receiveParrots = (parrots) => ({\\n    type: RECEIVE_PARROTS,\\n    parrots,\\n});\\n</code></pre>\\n<p>We also need to configure our application to use the <code>parrots</code> duck. We can do\\nthat in <code>configuration/reducers.js</code>:</p>\\n<pre><code>import parrots from 'ducks/parrots';\\n\\nexport default (history) => combineReducers({\\n    ...\\n    parrots,\\n});\\n</code></pre>\\n<p>Finally, we can connect the <code>ParrotsList</code> component to the Redux store:</p>\\n<pre><code>import React from 'react';\\nimport { Container } from 'reactstrap';\\nimport { connect } from 'react-redux';\\n\\nimport withView from 'decorators/withView';\\n\\nconst ParrotsList = ({ parrots }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;ul>\\n            {parrots.map((parrot) => (\\n                &#x3C;li key={parrot.id}>\\n                    &#x3C;a href={parrot.link}>{parrot.name}&#x3C;/a>\\n                &#x3C;/li>\\n            ))}\\n        &#x3C;/ul>\\n    &#x3C;/Container>\\n);\\n\\nconst mapStateToProps = (state) => ({\\n    parrots: state.parrots.parrots,\\n});\\n\\nconst ParrotsListConnector = connect(\\n    mapStateToProps,\\n)(ParrotsList);\\n\\nexport default withView()(ParrotsListConnector);\\n</code></pre>\\n<p>It is now possible to dispatch <code>RECEIVE_PARROTS</code> actions with some parrots and\\nsee them. Let's quickly try this out without any API requests just to make sure\\neverything works alright. Edit the <code>fetchUserParrots</code> saga:</p>\\n<pre><code>import { put } from 'redux-saga/effects';\\n\\nimport { receiveParrots } from 'ducks/parrots';\\n\\nexport default function* fetchUserParrots() {\\n    yield put(receiveParrots([\\n        { id: 1, name: 'Alex', link: 'https://www.youtube.com/user/doorbell26' },\\n        { id: 2, name: 'Benjamin', link: 'https://www.youtube.com/user/parrotpost' },\\n    ]));\\n}\\n</code></pre>\\n<p>And we should now be able to see the hard-coded parrots again! We dispatch the\\n<code>RECEIVE_PARROTS</code> action using <code>put</code>. The next thing to do is to make an API\\nrequest to retrieve the user's parrots and dispatch the action using those\\nparrots instead.</p>\\n<p>We could use <code>fetch</code> to make this API request, but we have a helper library for\\nmaking API requests called <code>tg-resources</code> (which uses <code>fetch</code> or <code>superagent</code>\\nunder the hood). Using <code>tg-resources</code>, we can configure a \\\"resource\\\" that can be\\nused to easily make API calls. Let's configure the <code>parrotsList</code> resource in\\n<code>services/api.js</code>. In the <code>createSagaRouter</code> arguments, add the <code>parrots</code>\\nresource like so:</p>\\n<pre><code>const api = createSagaRouter({\\n    ...\\n    parrots: {\\n        list: 'parrots/',\\n    },\\n}, {\\n    ...headers, apiRoot settings, etc.\\n});\\n</code></pre>\\n<p>We can now make use of this resource in the <code>fetchUserParrots</code> Saga:</p>\\n<pre><code>import { put } from 'redux-saga/effects';\\n\\nimport { receiveParrots } from 'ducks/parrots';\\nimport api from 'services/api';\\n\\nexport default function* fetchUserParrots() {\\n    try {\\n        const parrots = yield api.parrots.list.fetch();\\n        yield put(receiveParrots(parrots));\\n    } catch (err) {\\n        console.error('Something went wrong!');\\n    }\\n}\\n</code></pre>\\n<p>We call the <code>fetch</code> method on the <code>api.parrots.list</code> resource triggering a GET\\nrequest to <code>/api/parrots/</code>. Similarly, we could use <code>post</code> to make a POST\\nrequest with some data.</p>\\n<p>A simple way to check if server-side rendering works is to right click on the\\npage and selecting \\\"View Page Source\\\". The saved parrots should show up in the\\noriginal HTML the server sends to the browser.</p>\\n<p><strong>TODO: Explain generators and <code>yield</code>?</strong></p>\\n<h3>Creating parrots</h3>\\n<p>Currently, the only way to add parrots is via the admin page. This is a bit of a\\nproblem since then only admin users can add parrots. Also, it's quite\\ninconvenient to navigate to the \\\"add a parrot\\\" admin page. So, let's create a\\nnew view with a form for creating parrots.</p>\\n<p>Let's add a simple non-functional form view to <code>views/CreateParrot.js</code>:</p>\\n<pre><code>import React from 'react';\\nimport { Form, FormGroup, Label, Input, Button, Container } from 'reactstrap';\\n\\nconst CreateParrot = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Form>\\n            &#x3C;FormGroup>\\n                &#x3C;Label for=\\\"name\\\">Name&#x3C;/Label>\\n                &#x3C;Input name=\\\"name\\\" id=\\\"name\\\" />\\n            &#x3C;/FormGroup>\\n            &#x3C;FormGroup>\\n                &#x3C;Label for=\\\"link\\\">Link&#x3C;/Label>\\n                &#x3C;Input name=\\\"link\\\" id=\\\"link\\\" type=\\\"url\\\" />\\n            &#x3C;/FormGroup>\\n            &#x3C;Button>Create&#x3C;/Button>\\n        &#x3C;/Form>\\n    &#x3C;/Container>\\n);\\n\\nexport default CreateParrot;\\n</code></pre>\\n<p>And add a route for it in <code>configuration/routes.js</code>:</p>\\n<pre><code>const CreateParrot = loadable(() => import('views/CreateParrot'));\\n...\\n{\\n    path: '/parrots/create',\\n    exact: true,\\n    name: 'create-parrots',\\n    component: CreateParrot,\\n},\\n</code></pre>\\n<p>You should see a page like this at <code>/parrots/create</code>:</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-142b0.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 49.84709480122324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/0lEQVQoz52S207DMBBE/f+fwhMP/AOiQqhtGpAQ4gVR9QbN1UnsOFPP0hCXlnJ5ONo4ys7MeqMWyxVW6w2yvEBRauiqRqkrNMaiA9C6DnVjUNWN1PA5zXK8bxMkaSb9eVFCsZkiPFzfjDCNYkxnMWbxA0a3dxhPImmgAYUGDMq9ea9BFJ34MQ8vr3NpJtskxXrzJpUCzT5dCPtI+E718bWv2ju1zsmYjviZWY1tPfY0Ijgk/xSUFMaIwId7iD3D4b0OCf3Ij0/PWPoFMSWdv011lPCLIJ24lIvLK4yjexmZBodLOE8vqkJ113Ww/r7CX+S3HI18yu1fCX8S/GvSHeDlCJBahagrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #000;\\\"\\n        alt=\\\"Create parrot form\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-03540.png\\\"\\n        srcset=\\\"/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-b012f.png 200w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-375a8.png 400w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-03540.png 800w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-09d7b.png 1200w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-f2045.png 1600w,\\n/static/create-parrot-250a5db9a8c8c98e2d6f12e03befb297-142b0.png 1962w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>Unfortunately, we don't currently have access to any field values that the user\\ninputs. One option would be to convert the component to a class component and\\nkeep track of the name and the link in the component's state. Another option\\nwould be to use refs and manually query the name and link inputs for their\\nvalues when the user submits the form.</p>\\n<p>Those solutions require a lot of manual work though (especially for larger\\nforms). So, let's use a package that makes forms in React a breeze: Formik. We\\ncan convert our component to use Formik like so:</p>\\n<pre><code>import React from 'react';\\nimport { FormGroup, Label, Input, Button, Container } from 'reactstrap';\\nimport { Formik, Form } from 'formik';\\n\\nconst CreateParrot = () => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Formik\\n            initialValues={{ name: '', link: '' }}\\n            onSubmit={(values) => {\\n                console.log('Submitting!', values);\\n            }}\\n        >\\n            {({ values, handleChange }) => (\\n                &#x3C;Form>\\n                    &#x3C;FormGroup>\\n                        &#x3C;Label for=\\\"name\\\">Name&#x3C;/Label>\\n                        &#x3C;Input\\n                            name=\\\"name\\\"\\n                            id=\\\"name\\\"\\n                            value={values.name}\\n                            onChange={handleChange}\\n                        />\\n                    &#x3C;/FormGroup>\\n                    &#x3C;FormGroup>\\n                        &#x3C;Label for=\\\"link\\\">Link&#x3C;/Label>\\n                        &#x3C;Input\\n                            name=\\\"link\\\"\\n                            id=\\\"link\\\"\\n                            type=\\\"url\\\"\\n                            value={values.link}\\n                            onChange={handleChange}\\n                        />\\n                    &#x3C;/FormGroup>\\n                    &#x3C;Button type=\\\"submit\\\">Create&#x3C;/Button>\\n                &#x3C;/Form>\\n            )}\\n        &#x3C;/Formik>\\n    &#x3C;/Container>\\n);\\n\\nexport default CreateParrot;\\n</code></pre>\\n<p>Formik keeps track of the form's state internally and uses a render props based\\nAPI to allow us to access the state and modify it. It is very simple to add\\nvalidation, showing validation errors, and handling server errors. Even things\\nlike disabling the submit button when the user has clicked it is very simple.</p>\\n<p>You should now see a message logged to the console with the values you inputted.</p>\\n<p>Now, we need to send this data to the server so that the server can store the\\nparrot in the database. A very simple way to do it would be to just send a fetch\\nrequest in the <code>onSubmit</code> handler, but let's use a Saga for that.</p>\\n<p>Let's add a <code>createParrot.js</code> file to <code>sagas/parrots/</code> with the following\\ncontents:</p>\\n<pre><code>import { takeEvery } from 'redux-saga/effects';\\n\\n\\nconst CREATE_PARROT = 'CREATE_PARROT';\\n\\nexport const createParrot = (name, link) => ({\\n    type: CREATE_PARROT,\\n    name,\\n    link,\\n});\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    console.log('create parrot:', createParrotAction);\\n}\\n\\nexport default function* createParrotWatcher() {\\n    yield takeEvery(CREATE_PARROT, createParrotSaga);\\n}\\n</code></pre>\\n<p>This saga specifies its own action that it can react to -- <code>CREATE_PARROT</code>. The\\n<code>createParrotWatcher</code> will be watching for any dispatched <code>CREATE_PARROT</code>\\nactions and run <code>createParrotSaga</code> passing it the action as the argument.\\nCurrently we're just logging the <code>createParrotAction</code> in order to make sure that\\nwe get passed the correct data. Let's configure this Saga to \\\"watch\\\" for any\\nactions dispatched in the <code>/parrots/create</code> route by adding it as the <code>watcher</code>\\nfor that route in <code>routes.js</code>:</p>\\n<pre><code>{\\n    path: '/parrots/create',\\n    exact: true,\\n    name: 'create-parrots',\\n    component: CreateParrot,\\n    watcher: createParrotWatcher,\\n},\\n</code></pre>\\n<p>And finally, let's connect our <code>CreateParrot</code> component to Redux:</p>\\n<pre><code>...\\nimport { connect } from 'react-redux';\\n\\nimport { createParrot } from 'sagas/parrots/createParrot';\\n\\nconst CreateParrot = ({ createParrot }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Add a new parrot!&#x3C;/h1>\\n        &#x3C;Formik\\n            initialValues={{ name: '', link: '' }}\\n            onSubmit={(values) => {\\n                createParrot(values.name, values.link);\\n            }}\\n        >\\n            ...\\n        &#x3C;/Formik>\\n    &#x3C;/Container>\\n);\\n\\nconst mapDispatchToProps = (dispatch) => ({\\n    createParrot: (name, link) => dispatch(createParrot(name, link)),\\n});\\n\\nconst CreateParrotConnector = connect(\\n    null,\\n    mapDispatchToProps,\\n)(CreateParrot);\\n\\nexport default CreateParrotConnector;\\n</code></pre>\\n<p>Now, whenever the form is submitted, we dispatch the <code>CREATE_PARROT</code> action\\npassing it the name and the link.</p>\\n<p>We should now see the logged message in the console with the\\n<code>createParrotAction</code> including the specified <code>name</code> and <code>link</code>.</p>\\n<p>We can now send a POST request to the server using our <code>parrots.list</code> resource:</p>\\n<pre><code>...\\nimport api from 'services/api';\\n\\n...\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    try {\\n        const { name, link } = createParrotAction;\\n        yield api.parrots.list.post(null, { name, link });\\n    } catch (e) {\\n        console.log('Something went wrong!');\\n    }\\n}\\n\\n...\\n</code></pre>\\n<p>This <em>almost</em> works. We aren't currently sending the <code>user_id</code> field to the\\nserver, but since it's required, we get a <code>500</code> error saying that the <code>user_id</code>\\nfield cannot be <code>null</code>. It would be great if we didn't need to send this\\n<code>user_id</code> manually, but instead, Django would take the authenticated user and\\nsave the parrot to the database with that user's ID.</p>\\n<p>We can accomplish this very easily by overriding the <code>perform_create</code> method on\\nthe <code>ParrotViewSet</code> and passing the currently authenticated user to the\\nserializer:</p>\\n<pre><code>class ParrotViewSet(viewsets.ModelViewSet):\\n    ...\\n\\n    def perform_create(self, serializer):\\n        return serializer.save(user=self.request.user)\\n</code></pre>\\n<p>Creating parrots should now work! However, we don't actually see anything\\nhappening. Let's redirect the user to <code>/parrots</code> once the request has finished.\\nIn the <code>createParrot</code> Saga, modify the <code>createParrotSaga</code> function like so:</p>\\n<pre><code>import { push } from 'connected-react-router';\\nimport { takeEvery, put } from 'redux-saga/effects';\\n...\\n\\nfunction* createParrotSaga(createParrotAction) {\\n    try {\\n        const { name, link } = createParrotAction;\\n        yield api.parrots.list.post(null, { name, link });\\n\\n        yield put(push('/parrots'));\\n    } catch (e) {\\n        console.log('Something went wrong!');\\n    }\\n}\\n\\n...\\n</code></pre>\\n<p>Let's also add a link to <code>/parrots/create</code> to our <code>ParrotsList</code> component:</p>\\n<pre><code>...\\nimport { Link } from 'react-router-dom';\\n...\\nconst ParrotsList = ({ parrots }) => (\\n    &#x3C;Container>\\n        &#x3C;h1>Here are your parrots!&#x3C;/h1>\\n        &#x3C;Link to=\\\"/parrots/create\\\">\\n            Add a new parrot!\\n        &#x3C;/Link>\\n        ...\\n    &#x3C;/Container>\\n);\\n</code></pre>\\n<h3>Full source of Parrot-mania</h3>\\n<p>You can check out the full source of Parrot-mania here:\\n<a href=\\\"https://github.com/JoosepAlviste/parrot-mania\\\">https://github.com/JoosepAlviste/parrot-mania</a></p>\\n<h2>Future improvements to the template</h2>\\n<ul>\\n<li>Kubernetes</li>\\n<li>Out-of-the-box testing set up with <code>react-testing-library</code></li>\\n<li>GraphQL (???)</li>\\n</ul>\",\"frontmatter\":{\"title\":\"Charon\"}}},\"pathContext\":{\"slug\":\"/blog/thorgate-spa/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/blog-thorgate-spa.json\n// module id = 445\n// module chunks = 212854761677524"],"sourceRoot":""}